{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44648929-0a3ca09e28beb33e491a22410';\n\nexport async function fetchImages(searchTerm, currentPage) {\n  const url = 'https://pixabay.com/api/';\n  const params = {\n    key: API_KEY,\n    q: searchTerm,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  };\n\n  try {\n    const response = await axios.get(url, { params });\n\n    if (response.status !== 200) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n\n    const data = response.data;\n\n    return {\n      hits: data.hits.map(image => ({\n        webformatURL: image.webformatURL,\n        largeImageURL: image.largeImageURL,\n        tags: image.tags,\n        likes: image.likes,\n        views: image.views,\n        comments: image.comments,\n        downloads: image.downloads,\n      })),\n      totalHits: data.totalHits,\n    };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n","export function renderGallery(images, append = false) {\n  const gallery = document.getElementById('gallery');\n  const markup = images\n    .map(\n      image => `\n    <div class=\"photo-card\">\n      <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b> ${image.likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b> ${image.views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b> ${image.comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b> ${image.downloads}\n        </p>\n      </div>\n    </div>\n  `\n    )\n    .join('');\n\n  if (append) {\n    gallery.insertAdjacentHTML('beforeend', markup);\n  } else {\n    gallery.innerHTML = markup;\n  }\n}\n\nexport function clearGallery() {\n  const gallery = document.getElementById('gallery');\n  gallery.innerHTML = '';\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport { renderGallery, clearGallery } from './js/render-functions.js';\n\nconst form = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst gallery = document.getElementById('gallery');\nconst loadingIndicator = document.querySelector('.loader');\nconst btnLoadMore = document.querySelector('.btn');\n\nlet searchTerm = '';\nlet currentPage = 1;\nlet maxPage = 1;\nconst perPage = 15;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  searchTerm = searchInput.value.trim();\n\n  if (searchTerm === '') {\n    iziToast.error({\n      message: 'Please enter a search keyword.',\n    });\n    return;\n  }\n\n  clearGallery();\n  showLoadingIndicator();\n\n  try {\n    currentPage = 1;\n    const { hits: images, totalHits } = await fetchImages(\n      searchTerm,\n      currentPage\n    );\n    updateMaxPage(totalHits);\n\n    if (images.length === 0) {\n      iziToast.info({\n        message:\n          'Sorry, no images matching your search query were found. Please try again!',\n      });\n    } else {\n      renderGallery(images);\n      initializeLightbox();\n      searchInput.value = '';\n    }\n  } catch (error) {\n    console.error('Error loading images:', error);\n    iziToast.error({\n      message: 'Failed to load images. Please try again later.',\n    });\n  }\n  hideLoadingIndicator();\n});\n\nbtnLoadMore.addEventListener('click', async () => {\n  currentPage++;\n  try {\n    showLoadingIndicator();\n    const { hits: images, totalHits } = await fetchImages(\n      searchTerm,\n      currentPage\n    );\n\n    if (images.length > 0) {\n      renderGallery(images, true);\n      initializeLightbox();\n      scrollGallery();\n      updateMaxPage(totalHits);\n    } else {\n      iziToast.info({\n        message: 'No more images found.',\n      });\n    }\n  } catch (error) {\n    console.error('Error loading more images:', error);\n    iziToast.error({\n      message: 'Failed to load more images. Please try again later.',\n    });\n  }\n  hideLoadingIndicator();\n});\n\nfunction showLoadingIndicator() {\n  loadingIndicator.classList.remove('hidden');\n}\n\nfunction hideLoadingIndicator() {\n  loadingIndicator.classList.add('hidden');\n}\n\nfunction initializeLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a', {});\n  lightbox.refresh();\n}\n\nfunction updateMaxPage(totalHits) {\n  maxPage = Math.ceil(totalHits / perPage);\n\n  if (currentPage >= maxPage) {\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    hideLoadBtn();\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction showLoadBtn() {\n  btnLoadMore.classList.remove('hidden');\n}\n\nfunction hideLoadBtn() {\n  btnLoadMore.classList.add('hidden');\n}\n\nfunction scrollGallery() {\n  const firstNewImage = gallery.querySelector('.photo-card:not(.old)');\n\n  if (firstNewImage) {\n    const elementHeight = firstNewImage.getBoundingClientRect().height;\n    const scrollHeight = elementHeight * 3;\n\n    scrollBy({ top: scrollHeight, behavior: 'smooth' });\n\n    gallery\n      .querySelectorAll('.photo-card')\n      .forEach(card => card.classList.add('old'));\n  }\n}\n"],"names":["API_KEY","fetchImages","searchTerm","currentPage","url","params","response","axios","data","image","error","renderGallery","images","append","gallery","markup","clearGallery","form","searchInput","loadingIndicator","btnLoadMore","maxPage","perPage","event","iziToast","showLoadingIndicator","totalHits","updateMaxPage","initializeLightbox","hideLoadingIndicator","scrollGallery","SimpleLightbox","hideLoadBtn","showLoadBtn","firstNewImage","scrollHeight","card"],"mappings":"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"}